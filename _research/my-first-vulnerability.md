---
title: "Sample Vulnerability Analysis"
date: 2025-01-01
category: web-security
severity: medium
---

# My first research

<pre>This is a document on studying signal path from coax to user management.
If you expect acedmic writing over integral information you are in the wrong place.
If you are an anxious impatient read like me skip to the WHAT WE LEARNED sections for TLDR

Simplified signal path

[coax] -&gt; [modem] -&gt; [ethernet] -&gt; [nic] -&gt; [kernel driver] -&gt; [network stack] -&gt;

[application layer] -&gt; [user/system response]


--------------------------------------------------------

1. Coax Cable Transmission

General Knowledge:

coaxial cable carries modulated analog radio frequency signals
(continuous waves that encode digital data)

this is used primarily by Data Over Cable Service Interface Specification (DOCSIS)
for cable internet.

---

DOCSIS * The data I could find reference DOCSIS4.0 But did not give pertininent information on it *
	* Current working DOCSIS beneath DOCSIS4.0 is 3.1 *

Data Over Cable Interface Specification is an internation telecommunications
standard that permits the addition of high-bandwidth data transfer to an existing
cable television(CATV) system.

Physical Layer
	Channel width:

		-Downstream:
		 All versions of DOCSIS earlier than 3.1 use either 6 MHz channels
		 (North America) OR 8 MHz (EuroDOCSIS). DOCSIS 3.1 uses channel bandwidths up
		 to 192 MHz.

		-Upstream:
		 DOCSIS 1.0/1.1 specifies channel widths between 200Khz and 3.2 MHz.
		 DOCSIS 2.0 &amp; 3.0 specify 5.4MHz, but can use the earlier, narrower channel
		 widths for backward compatability. DOCSIS 3.1 uses channel bandwidths of up to
		 96MHz in the upstream


	Modulation: * The process of converting digital into analog for transmission *
			* QAM - Quadtrature Amplitude Modulation *

		-Downstream:
		 All versions of DOCSIS prior to 3.1 specify that 64-level or 256-
		 level QAM (64-QAM or 256-QAM) be used for modulation of downstream data using
		 the correct level of standard for operation(framework, coding and distribution).

		 3.1 adds 16-QAM, 128-QAM, 512-QAM, 1024-QAM, and 4094-QAM, with optional
		 support of 8192-QAM/16384-QAM.

		-Upstream:
		 Upstream data uses QPSK(Qaudrature Phase-Shift Keying) or 16-level QAM for DOCSIS1.x
		 While QPSK, 8-QAM, 16-QAM, 32-QAM, and 64-QAM are used for DOCSIS 2.0 &amp; 3.0.
		 DOCSIS 2.0 &amp; 3.0 also support 128-QAM with trellis coded modulation in S-CDMA mode.

		 DOCSIS 3.1 supports daya modulations from QPSK up to 1024-QAM, with optional
		 support for 2048-QAM and 4096-QAM.

Data Link Layer
	DOCSIS employs a mixture of access methods for upstream transmissions, specifically time-
	division mutliple access (TDMA) for DOCSIS 1.0/1.1 and both TDMA and S-CDMA for DOCSIS
	2.0 &amp; 3.0 with a limited use of contention for bandwidth reservation requests. In TDMA,
	a cable modem requests a time to transmit and the CMTS grants it an available time slot.

	For DOCSIS 1.1 and above, the data layer also includes extensive quality of service (QOS)
	features that help to efficiently support applications that have specific traffic
	requirements such as low latency (VoiP).
	DOCSIS 3.0 feature channel bonding, which enables multiple downstream and upstream
	channels to be used together at the same time by a single subscriber.

Throughput
	Bandwidth is shared among users of an HFC, within service groups which are groups of
	customers that share RF channels.

	The first three versions of DOCSIS standard support a downstream throughput with 256-QAM
	of up to 42.88Mbit/s per 6MHz channel(Approximately 38Mbit/s after overhead), or
	55.62 Mbit/s per 8 MHz channel for EURODOCSIS(approximately 27Mbit/s after overhead).
	The upstream throughput is possible at 30.72Mbit/s per 6.4 MHz channel (approximately
	27 Mbit/s after overhead), or 10.24 Mbit/s per 3.2 MHz channel (approx. 9Mbit/s after
	overhead).

	DOCSIS 3.1 supports a downstream throughput with 4096-QAM and 35 kHz subcarrier spacing
	of up to 1.89Gbit&apos;s per 192 MHz OFDM channel. The upstream throughput possible is 0.94
	Gbit/s per 96 MHz OFDMA channel

Network Layer
	DOCSIS modems are managed via an IP address
	The DOCSIS 2.0 + IPV6 specification allowed support on DOCSIS 2.0 modems via firmware update
	DOCSIS 3.0 added management over IPV6

Equipment
	DOCSIS consists of two primary componemts: a cable modem and a cable modem termination
	system (CMTS) located at the CATV headend

Security
	DOCSIS uses media access control (MAC) in its Baseline Privacy Interface (BPI) specs.
	DOCSIS 1.0 used the initial BPI. It was later improved with BPI+ used in DOCSIS versions
	1.1 and 2.0. A number of enhancements have been made to the BPI in DOCSIS 3.0 and the
	specification was actually just renamed SEC for security.

	SEC intends to stop cable users from listening to each other by encrypting data flows
	between CMTS and the cable modem. BPI and BPI+ use 56-bit Data Encryption Standard (DES),
	while SEC also adds support for 128-bit Advanced Ecnryption Standard (AES). The AES key
	is protected by a 1024-bit RSA key.

	BPI+ extends its protection by implementing digital certificate based authentication to
	its key exhange protocol.It uses a Public Key Infastructure(PKI) based on digital
	ticket authorities (CAs) of the certification testers. Typically the cable service
	operator adds the modems MAC manually to the service users account, allowing access
	only to a cable modem that can attest to that MAC address using a valid certificate
	issued via the PKI. Early BPI (ANSI/SCTE22-2) had underlying key managemenet issues
	where the protocol did not authenticate the user&apos;s cable modem.

	Successful attacks often occur when the CMTS is configured for backward compatibility
	with early pre-standard DOCSIS 1.1 modems. These modems were &quot;Software Upgradable&quot; in
	the field but did not include valid DOCSIS or EURODOCSIS root CAs.

WHAT WE LEARNED:
A wave of data is sent using RF and modulated using a protocol deterministic on the DOCSIS version.
One could easily have a chart handy for quick access to specifics if confused.
Specifics:
Physical band width, frequency, sec, frameworks are all version specific. DOCSIS &lt;&lt; 1.1 is gold

			=== Basic Chart ===
=================================================================.
DOCSIS Version | Production Date | Max Downstream | Max Upstream |
-----------------------------------------------------------------.
     1.0       |       1997	 |                |              |
---------------|-----------------|                |   10 Mbit/s  |
     1.1       |       2001      |    40 Mbit/s   |		 |
---------------|-----------------|                |--------------|
     2.0       |       2002      |   		  |   30 Mbit/s  |
---------------|-----------------|----------------|--------------|
     3.0       |       2006      |    1 Gbit/s    |  200 Mbit/s  |
---------------|-----------------|----------------|--------------|
     3.1       |       2013      |		  |  1 -2 Gbit/s |
---------------|-----------------|   10 Gbit/s    |--------------|
     4.0       |       2017      |                |    6 Gbit/s  |
-----------------------------------------------------------------^

source:wikipedia
---
QAM: Quadrature Amplitude Modulation

	QAM is a method of combining two amplitude modulation (AM) signals into a single channel.
	This scheme helps double the channels effective bandwidth. QAM is also used with pulse AM
	in digital systems.

How does QAM work?

	QAM is used to increase spectrum efficiency. It accomplishes this task by utlizing both
	phase and amplitude components to modulate or alter the waveform. The following example
	consists of two signals known as carrier waves.

	One signal is call the I signal and the other is the Q signal. This is also why QAM
	is referred to as IQ modulation. Mathematically on of the signals can be represented
	with a sine wave and the other by a cosine wave. These carrier waves each have the same
	frequency but differ in phases by 90 degrees, or one quarter cycle. Also, they are 90
	degrees out of phase with each other, which is why they are orthogonal or in quadtrature
	with each other.

	The two signals are represented by cos(θ) = sin (θ-90°)

	The two modulated carriers combine at the source -- within a QAM waveform -- for
	transmission. The modulator works like a translator. Its job is to encode, or translate
	digital packets into an analog signal, thus ensuring transfers. The combined carrier
	signals are then transmetted over the same channel to the demodulator(receiver)

	At the destination, the demodulator seperates the carrier waves and extracts the data
	from each. A low-pass filter -- an electronic circuit that surpresses higher
	frequencies -- is used to extract the in-phase and quatrature components of the signal.
	Then the data is incorporated into the original modulating information.

Analog QAM vs Digital QAM

Analog QAM:
	Analog QAM enables carriers to transmit multiple analog signals. For example
	QAM is used in Phase Alternating Line (PAL) and National Television
	Systems Committee (NTSC). In this case the different channels QAM provides
	enables the signal to carry components of color or chroma data

	A system known as Compatible QUAM is found in AM stereo brodcasting applications
	in the US and other countries. This scenario involves two distinct modulation
	stages: conventional AM and a compatible quadtrature phase modulation. The
	different channels enable the required two channels for stereo to be carried by
	a single carrier. It uses dedicated circuitry to encode a stereo seperation
	signal that is compatible with older receivers.

Digital QAM:
	Version of digital QAM are often called quantized QAM. The are built into most
	radio commuinications systems that use data. For example, radio communications
	technologies ranging from 4G and 5G cellular systems to use different types of
	QAM. As the field evolves, the number of QAM systems used in radio communications
	is likely to increase.

WIFI and QAM
	QAM continues to be used with the latest WIFI standard currently WIFI7. This is known
	as 4096-QAM or 4kQAM with a better security and uptime than its former versions.
	This is crucial for devices that operate a 4k streaming application for example.
	WIFI 6holds a 1024-QAM standard how ever it is more prone to intereference
	then the former 256-QAM that is the standard for WIFI5.

Cable TV and QAM
	QAM systems are popular in the cable television industry. In the US 64-QAM and 256-QAM
	are commonly used for digital TV series. Muliple System Operators (MSO) and other
	network operators use QAM to deliver services as it provides formatting services in
	hubs where signals are processed and distributed over the cable operators network.
	Once in a residence the cable modems and set-tops convert QAM signals back into their
	original format.

WHAT WE LEARNED:

	QAM maps binary data to complex waveforms by AMPLITUDE: how tall the wave is, and PHASE:
	where in the cycle it is. This symbol represents a STATE of binary (0000000) which
	is translated in real time into machine langauge.
               === Basic Chart ===
_____________________________________________________
|           | 802.11ac |   802.11ax   |   802.11be   |
=====================================================.
| Frequency |  5 Ghz   |2.4 GHz, 5 Ghz|  2.4/5/6 GHz |
-----------------------------------------------------.
|    Bits   |    4     |       8      |       16     |
-----------------------------------------------------.
|  Max Rate | 6.9Gbps  |    9.6 Gbps  |    46 Gpbs   |
-----------------------------------------------------.
|   AP Cap. |   OFDM   |     OFDM     |    OFDMA     |
-----------------------------------------------------.
|    QAM    | 256-QAM  |   1024-QAM   |   4096-QAM   |
-----------------------------------------------------.
|  MU-MIMO  | Downlink |  UP/DOWNlink |  UP/DOWNlink |
-----------------------------------------------------*
source:techtarget
---

Radio Frequency Bands
	The radio frequency spectrum (RF) is one such part of the electromagnetic spectrum
	that overlaps our sub-THz range at its lower end. Accordingly, Electromagnetic waves in
	this frequency range are called radio requency bands or simply &apos;radio waves&apos;. RF bands
	spread in the range between 30kHz and 300GHz (alternative point of view offers 2kHz -
	300GHz). All known transmission systems are operated in the RF spectrum range.

	Honestly researching this you are better to just go look at the millions of charts on
	google to get a better idea. Its actually fairly simple, here is a basic chart established
	as the standard among professionals. The difference in charts is mostly naming conventions
	per industry standard.

__________________________________________________________
|   Band  | Frequency Range  ||  Band   | Frequency Range |
|=========|==================||=========|=================.
| R band  | 1.70 to 2.60GHz  || K band  | 18.0 to 26.5GHz |
|---------|------------------||---------|-----------------*
| D band  | 2.20 to 2.20GHz  || Ka band |  26.5 to 40GHz  |
|---------|------------------||---------|-----------------*
| S band  | 2.60 to 3.95GHz  || Q band  |   33 to 50GHz   |
|---------|------------------||---------|-----------------*
| E band  | 3.30 to 4.90GHz  || U band  |   40 to 60GHz   |
|---------|------------------||---------|-----------------*
| G band  | 3.95 to 5.85GHz  || V band  |   40 to 75GHz   |
|---------|------------------||---------|-----------------*
| F band  | 4.90 to 7.05GHz  || E band  |   60 to 90GHz   |
|---------|------------------||---------|-----------------*
| C band  | 5.85 to 8.20GHz  || W band  |   75 to 110GHz  |
|---------|------------------||---------|-----------------*
| H band  | 7.05 to 10.10GHz || F band  |  90 to 140 GHz  |
|---------|------------------||---------|-----------------*
| X band  | 8.2 to 12.5GHz   || D band  |  110 to 170GHz  |
|---------|------------------||---------|-----------------*
| Ku band | 12.4 to 18.0GHz  || Y band  |  325 to 500GHz  |
----------------------------------------------------------*

WHAT WE LEARNED:
	RF bands come in a multitude of frequencies. Each band has a different naming convention
	dependant on frequencies used within the band. The RF spectrum overlaps with the
	electromagnetic spectrum.
source:terasense
---

CMTS(Cable Modem Termination System): The ISPS head end that talks to your modem

	A cable modem termination system or CTMS for short can also be referred to as a
	CMTS Edge Router. Its a piece of equipment typically located in a cable company&apos;s head
	end or hubsite, which is used to provide data services such as cable internet or VOIP.
	CMTS provides similar functions to a DSLM in a digital subscriber line or optical
	optical line termination in a passive optical network.


Connections:
	In order to provide highspeed data services, a cable company will connect its headend
	to the internet via high capacity data links. These head ends will inturn communicate
	with subscribers cable modems. Different CMTS are capable of serving different cable modem
	population sizes -- ranging from 4000 modems to over 150 000. A given headend may have
	between 1 - 12 CMTS.

	A service group is a group of customers that share the same RF channels and thusi bandwidth.
	A CMTS has seperate RF interfaces and connectors for the downlink and uplink signals. The
	RF/COAX interface carry RG signals to and from coaxial trunks connected to the customers
	home modem. Ever connector has a finite number channels it can carry, such as 16 downstream
	and 4 channels upstream per connector. A service group may serve up to 500 households.
	Channels are regrouped at the headend or distritution hub and serviced by CMTSs and other
	equipment such as Edge QAMs.

	The RF signals from a CMTS are connected via coaxial cable to headend RF management modules
	for splitting and combining, with other equipement such as other CMTSs so that serveral
	CMTS can service one service group, and then to an optics platform or headend platform,
	which has transmitter and receiver modules that turn RF signals into light pulses for
	delivery over fiber optics through a hybrid fiber-coaxial network. Most CMTS will have
	an ethernet port in order to bridge or route traffic such as your own modem and or router.

	CMTS typically only carry IP traffic. Traffic destined for the cable modem from the
	internet, or downstream traffic, is carried in IP packets encapsulated according to the
	DOCSIS standard. These packets are then modulated onto a TV channel using either
	64-QAM, or 256-QAM to give us 8-bit architecture. (If you&apos;re new this is where it
	clicked for me).

	Upstream data (data from the headend or internet) is carred on data streams that are
	encapsulated DOCSIS frames modulated with QPSK, 16-QAM, 32-QAM, 64-QAM or 128-QAM
	using Time Division Multiple Access(TDMA), Advanced TDMA(ATDMA) or Synchronous Code
	Division Multiple Access(S-CDMA) frequenzy sharing mechanisms. This is usually done at
	the subband or return portion of the cable TV spectrum ( also known as T channels ),
	a much lower part of the frequency spectrum than the downstream signal, usually 5-42MHz
	in DOCSIS2.0 or 5-65MHz in EuroDOCSIS.


	A typical CMTS allows a subscribers computer to obtain an IP address by forwarding DHCP
	requests to the relevant servers. The DHCP returns for the most part, what looks like a
	typical response including an assigned IP address for the computer, gateway/router
	addresses to use, DNS servers etc.

	The CMTS may also implement some basic filtering to protect against unauthorized users
	and various attacks. Traffic shapingis sometimes performed to prioritize application
	traffic, perhaps based upan subscribed plan or download usage. This is also to provide
	guaranteed Quality of Service(QoS) for the cable operator&apos;s own PacketCable-based VOIP
	service. However, the function of traffic shaping is more likely done by a Cable Modem
	or policy traffic switch. A CMTS may also act as a bridge or router.

	A customer&apos;s cable modem cannot comunnicate directly directly with other modemsn on
	the line. In general, cable modem traffic is routed to other cable modems or to the
	Internet through a series of CMTSs and traditional routers. However, a route could
	conceivably pass through a single CMTS.

	A Converged Cable Access Platform(CCAP) combines CMTS and EDGE QAM functionality in a
	single device so that it can provide both data(internet) with CMTS functionality,
	and TV channels with Edge-QAM functionality. Edge-QAM converts video send via IP or
	otherwise, into a QAM signal for delivery over a cable network. EDGE QAMs are
	normally stand-alone devices placed at the &quot;Edge&quot; of a network. They can also be
	connected to a CMTS core, to make an M-CMTS system which is more scalable.

Architecures
	A CMTS can be broken down into several different architectures, Integrated CMTS (I-CMTS),
	virtual CMTS(vCMTS), and remote CMTS. An I-CMTS incorporates intoa single unit all components
	neccassary for its operation. There are both pro&apos;s and cons to each type of architecture.

Modular CMTS (M-CMTS)
	In a M-CMTS solution the architecture of an I-CMTS is broken up into two components. The
	first part is the Physical Downstream component(PHY) which is known as the Edge QAM (EQAM).
	The second part is IP networking and DOCSIS MAC Component which is referred to as the
	M-CMTS Core. There are also several new protocols and components introduced with this type
	of architecture. One if the DOCSIS Timing Interface, which provides a reference
	frequency between EQAM and M-CMTS Core via a DTI Server. The Second is the Downstream
	External PHY Interface(DEPI). The DEPI protocol controls the delivery of DOCSIS frames
	from the M-CMTS Core to the EQAM devices. Some of the challenges that entail an M-CMTS
	architecture is that it is extremely scalable to larger numbers of downstream channels.

Virtual CMTS
	Virtual CCAPs(VCAPPs) or virtual CMTS(vCMTS) are implemented on commercial off the shelf
	x86-based servers with specialized softeware and can be used to increase service capacity
	without purchasing new CMTS/CCAP chassis or add features to the CMTS/CCAP more quickly.

Remote CMTS
	Remote CMTS/Remote CCAP moves all CMTS/CCAP functionality to the outside plant, in stark
	contrast to conventional CMTSs or CCAPs which are installed at a service provider
	location.

WHAT WE LEARNED:
	A cable modem access system or CMTS for short is a system used by providers to forward
	requests through DHCP to the relevant servers in order to provide their service. Typically
	used to assign IP to subscribers, and handle IP traffic, the architectures can very per setup.
	Architectures are Integrated, Modular, and Remote.

source:wikipedia
---

HARDWARE
Coaxial cable: Carries the RF signal from ISP to your modem
Modem: Modulator-Demodulator - converts the RF signal to digital packets over ethernet


------------------------------------------------------------


2. Modem to Ethernet (Layer 1 &amp; 2)

General Knowledge:

The modem demodulates the signal and extracts digital frames
Converts to ethernet frames(Layer 2) and sends via copper Ethernet(RJ45, twisted pair)


---
Ethernet frame:
	In computer networking, an Ethernet frame is a data link layer protocol data unit and uses
	the underlying Ethernet physical layer transport mechanisms. In other words, a data unit
	on an Ethernet link transports an Ethernet frame as its payload.

	An ethernet frame is preceded by a preamble and start from delimter (SFD), which are both
	part of the Ethernet packet at the physical layer. Each Ethernet frame starts with an
	Ethernet header, which contains destination and source MAC addresses as its first two fields.
	The middle section of the frame is the payload data including any headers for other protocols
	such as IP. The frame ends with a Frame Check Sequence(FCS) which is a 32-bit Cyclic
	Redundancy Check -- a type of checksum that detects errors by performing polynomial-based
	calculations on the frame&apos;s contents. This helps ensure data integrity during transmission.
							__________________________
	*octets = bytes*		      	       |	Octets		  |
							--------------------------
	Ethernet packet					Length | Layer 2 | Layer 3
		|				       (octets)|	 |
		|-&gt; Preamble            	           7   | Not in  |
		|-&gt; SFD 				   1   | Frame   |
		|--------------------------------------------------------|
		|-&gt; Destination MAC Address		   6   |	 | 72 - 1530 octets
		|-&gt; MAC Source				   6   |         |
		|-&gt; 802.1Q tag (optional)       	  (4)  |         |
		|-&gt; EtherType(E2) or length(802.3)         2   |   64 -  |
		|-&gt; Payload		             42 - 1500 |   1522  |
		~				          -    |         |
		|-&gt; FCS				          4    |         |
		|----------------------------------------------------------------------
		|-&gt; Interpacket			         12    | Not in  |    12 octets
		     Gap (IPG)			                 frame

Structure
	A data packet on the wire with the frame as its payload consist of binary data. Ethernet
	transmits data with the most-significant octet (byte) first; within each octect, however,
	the least-significant bit is transmitted first.

	The internal structure of an Ethernet frame is specified in IEEE 802.3. The table below
	shows the complete Ethernet packet and the frame inside, as transmitted, for the payload
	size up to the MTU of 1500 octets. Some implementations of Gigabit Ethernet and other
	higher speed variants of Ethernet support larger frames, known as jumbo frames.



WHAT WE LEARNED: 
source:wikipedia
---
PHY: Physical layer of Ethernet, converts bits to voltage signals
WHAT WE LEARNED:
source:
---
MAC: Media Access Control - Handles addressing and channel access
WHAT WE LEARNED:
source:
-------------------------------------------------------------

3. Ethernet To Network Interface Card (NIC)

General knowledge:
The NIC receives electrical signals and parses the bitstream into structured frames
Sends these frames to the kernel driver of the OS (software level (STACK) starts here)

TODO:
NIC: Your systems network adapter
Interrupts/DMA: The NIC uses DMA (Direct Memory Access) and interrupts the CPU when data arrives
MTU(Maxiumum Transmission Unit): Usually 1500 bytes per ethernet frame.
This is the default max packet size(without fragmentation)


--------------------------------------------------------------

4. Kernel Network Stack(Layer 3-4)

General Knowledge:
The NIC hands the data to the kernels TCP/IP stack
The stack processes:
	IP packets - Layer 3: Routing info, TTL, fragmentation
	TCP/UDP segments - Layer 4: portnumbers, sequencing, reliability
TODO:
IP Header: Contains source/dest IPs, flags, TTL, checksum
TCP Flags: SYN, ACK, FIN, ETC - control connection behaviour
Ports: Logical end points 

------------------------------------------------------------

5. Application Layer &amp; User Space(Layer 5-7)

General Knowledge:
Packet is handed to the user-space application - browser or curl
If a response is need (SYN -&gt; SYN-ACK), the system forms a return packet and
transmits it back through the stack.
-----------------------------------------------------------


Questions:

How does the machine know what to do:

The machine is &quot;open&quot; and just listening (and vulnerable if not secured properly) 

Minimal Trigger
A single ethernet frame (e.g ARPm ICMP, TCP SYN) can be enough to trigger logic
	- A modern server could recieve 10Gbps+ of such frames

Packet Size
A minimum Ethernet Frame = 64 bytes
A SYN scan sends tiny TCP packets with just a flag
Even one maliscious TCP packet can cause a denial of service if a vulnerable
service mishandles it


------

Can I hook up my own machine to coax?

Technically yes.

A software-defined radio (SDR) or signal generator can be used to emit signals
BUT 
to interface meaningfully you need:
	- DOCSIS chipsets or emulation
	- Proper RF modulation
	- Authentication to ISP

Illegality:
- Injecting signals into coax == FCC violation(North America)
- Jamming frequencies even accidental = federal offense
- Easily traced, especially in urban areas.

--------------

Why?

The Pioneer Mindset

Early engineers had no blueprints
They physically tested waveforms, timing, and noise thresholds
Designed hand crafted modems before protocols existed
Built signal processors and designed chips by hand




</pre>
